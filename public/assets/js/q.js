var url=new URL(location.href),playerid=url.searchParams.get("id"),quizID=url.searchParams.get("quizID");const info_box=document.getElementById("info"),continue_btn=document.getElementById("continue"),quiz_box=document.getElementById("quiz"),result_box=document.getElementById("result_box"),option_list=document.getElementById("option_list"),timeText=document.getElementById("time_text"),timeCount=document.getElementById("timer"),next_btn=document.getElementById("next"),next_btn2=document.getElementById("next2");quiz_box.style.display="none",result_box.style.display="none",next_btn.style.display="none",next_btn2.style.display="none";var js=document.createElement("script");js.src="quizes/"+quizID+".js",document.getElementById("cont").appendChild(js);let counter,que_count=0,que_numb=1,userScore=0,incorque=0;continue_btn.classList.remove("d-none"),continue_btn.onclick=()=>{info_box.style.display="none",quiz_box.style.display="block",showQuetions(0),queCounter(1),startTimer(timeValue)};const restart_quiz=document.getElementById("restart");restart_quiz.onclick=()=>{quiz_box.style.display="block",result_box.style.display="none",timeValue=20,que_count=0,que_numb=1,userScore=0,incorque=0,widthValue=0,showQuetions(que_count),queCounter(que_numb),clearInterval(counter),startTimer(timeValue),timeText.innerHTML="<i class=\"bi bi-clock-history\"></i>",next_btn.style.display="none",next_btn2.style.display="none"};const bottom_ques_counter=document.getElementById("total_que"),bottom_ques_counter2=document.getElementById("total_que2");next_btn.onclick=()=>{que_count<questions.length-1?(que_count++,que_numb++,showQuetions(que_count),queCounter(que_numb),clearInterval(counter),startTimer(timeValue),timeText.innerHTML="<i class=\"bi bi-clock-history\"></i>",next_btn.style.display="none",next_btn2.style.display="none"):(clearInterval(counter),showResult())},next_btn2.onclick=()=>{que_count<questions.length-1?(que_count++,que_numb++,showQuetions(que_count),queCounter(que_numb),clearInterval(counter),startTimer(timeValue),timeText.innerHTML="<i class=\"bi bi-clock-history\"></i>",next_btn.style.display="none",next_btn2.style.display="none"):(clearInterval(counter),showResult())};let optionStart="<div class=\"col mt-2\"><div class=\"card h-100 shadow-sm option\" id=\"option\"><div class=\"row\"><div class=\"col my-auto\">",optionEnd="</div><div class=\"col-auto my-auto\" id=\"icon\"></div></div></div></div>";function showQuetions(a){const b=document.getElementById("que_text");var c="",d="",e="",f="",g="",h=0;!0==answerMixing&&shuffle(questions[a].options);let j=questions[a].numb+". "+questions[a].question;""!=questions[a].options[0]&&(c=optionStart+htmlEncode(questions[a].options[0])+optionEnd,h++);questions[a].options[1]!=null&&(d=optionStart+htmlEncode(questions[a].options[1])+optionEnd,h++);questions[a].options[2]!=null&&(e=optionStart+htmlEncode(questions[a].options[2])+optionEnd,h++);questions[a].options[3]!=null&&(f=optionStart+htmlEncode(questions[a].options[3])+optionEnd,h++);questions[a].options[4]!=null&&(g=optionStart+htmlEncode(questions[a].options[4])+optionEnd,h++);let k="row-cols-md-"+h;option_list.classList.add(k);let l=c+d+e+f+g;b.innerHTML=j,option_list.innerHTML=l;const m=option_list.querySelectorAll("#option");for(i=0;i<m.length;i++)m[i].setAttribute("onclick","optionSelected(this)")}let tickIconTag="<i class=\"bi bi-check2-circle text-end text-success fs-2\"></i>",crossIconTag="<i class=\"bi bi-dash-circle text-end text-danger fs-3\"></i>";function optionSelected(a){clearInterval(counter);let b=htmlEncode(a.textContent),c=htmlEncode(questions[que_count].answer);const d=option_list.children.length;if(b==c){userScore+=1,a.classList.remove("option"),a.classList.add("correct");let b=a.querySelector("#icon");b.innerHTML=tickIconTag}else{incorque+=1,a.classList.remove("option"),a.classList.add("incorrect");let b=a.querySelector("#icon");for(b.innerHTML=crossIconTag,i=0;i<d;i++)if(htmlEncode(option_list.children[i].textContent)==c){let a=option_list.children[i].querySelector("#option");a.classList.remove("option"),a.classList.add("correct");let b=option_list.children[i].querySelector("#icon");b.innerHTML=tickIconTag}}for(i=0;i<d;i++)option_list.children[i].classList.add("pe-none");next_btn.style.display="block",next_btn2.style.display="block"}function showResult(){info_box.style.display="none",quiz_box.style.display="none",result_box.style.display="block";const a=document.getElementById("score");let b="<table class=\"table\"><tr><th scope=\"row\">\u049A\u0430\u0442\u0435:</th><td>"+incorque+"</td></tr><tr><th scope=\"row\">\u0414\u04B1\u0440\u044B\u0441:</th><td>"+userScore+"</td></tr><tr><th scope=\"row\">\u0411\u0430\u0440\u043B\u044B\u049B \u0441\u04B1\u0440\u0430\u049B \u0441\u0430\u043D\u044B:</th><td>"+questions.length+"</td></tr></table>";a.innerHTML=b;var c=new XMLHttpRequest,d="https://kzredubot.herokuapp.com/highscore/"+userScore+"?id="+playerid;c.open("GET",d,!0),c.send()}function startTimer(a){function b(){if(timeCount.textContent=a,a--,9>a){let a=timeCount.textContent;timeCount.textContent="0"+a}if(0>a){clearInterval(counter),timeText.innerHTML="<i class=\"bi bi-clock-history\"></i>";const a=option_list.children.length;let b=questions[que_count].answer;for(i=0;i<a;i++)if(option_list.children[i].textContent==b){let a=option_list.children[i].querySelector("#option");a.classList.remove("option"),a.classList.add("correct");let b=option_list.children[i].querySelector("#icon");b.innerHTML=tickIconTag}for(i=0;i<a;i++)option_list.children[i].classList.add("pe-none");next_btn.style.display="block"}}counter=setInterval(b,1e3)}function htmlEncode(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&#34;").replace(/\//,"&#x2F;")}function queCounter(a){let b="\u2116 "+a+" / "+questions.length+" \u0441\u04B1\u0440\u0430\u049B";bottom_ques_counter.innerHTML=b,bottom_ques_counter2.innerHTML=b}function shuffle(a){a.sort(()=>Math.random()-.5)}